<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>地鐵透視留言板</title>
    <style>
        body {
            margin: 0;
            background: #000;
            font-family: "PingFang TC", "Microsoft JhengHei", sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            overflow: hidden;
        }

        .phone-mockup {
            position: relative;
            width: 100%;
            max-width: 400px;
            aspect-ratio: 9 / 19.5;
            background: #111;
            overflow: hidden;
            box-shadow: 0 20px 50px rgba(0,0,0,0.8);
        }

        video#train-video {
            position: absolute;
            width: 100%;
            height: 100%;
            object-fit: cover;
            z-index: 1;
        }

        /* 文字容器：處理梯形透視 */
        .perspective-container {
            position: absolute;
            top: 28%; /* 根據截圖中綠板的高度位置調整 */
            right: 10%;
            width: 60%;
            height: 20%;
            z-index: 2;
            /* 建立透視點 */
            perspective: 600px;
            pointer-events: none;
        }

        /* 實際文字內容：套用旋轉達成梯形變形 */
        .perspective-content {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            color: white;
            font-size: 2.2rem;
            font-weight: bold;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            
            /* 核心：Y軸旋轉產生近大遠小的梯形效果 */
            transform: rotateY(-25deg) rotateX(2deg);
            transform-style: preserve-3d;
            
            /* 初始狀態：寬度為0，用來模擬被火車遮住的感覺 */
            overflow: hidden;
            width: 0%;
            white-space: nowrap;
            border-right: 0px solid transparent; /* 隱形邊界 */
        }

        /* 輸入區域 */
        .input-panel {
            position: absolute;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            width: 85%;
            z-index: 10;
            display: flex;
            background: rgba(0,0,0,0.6);
            padding: 8px;
            border-radius: 25px;
            backdrop-filter: blur(5px);
        }

        input {
            flex: 1;
            padding: 10px 15px;
            border-radius: 20px;
            border: none;
            background: transparent;
            color: white;
            outline: none;
        }

        button {
            padding: 8px 20px;
            border-radius: 20px;
            border: none;
            background: #4CAF50;
            color: white;
            cursor: pointer;
            font-weight: bold;
        }
    </style>
</head>
<body>

    <div class="phone-mockup">
        <video id="train-video" playsinline>
            <source src="Train.mov" type="video/quicktime">
            <source src="Train.mov" type="video/mp4">
        </video>

        <div class="perspective-container">
            <div id="reveal-text" class="perspective-content">
                </div>
        </div>

        <div class="input-panel">
            <input type="text" id="userMsg" placeholder="輸入留言..." value="白六愛媽媽">
            <button onclick="revealMessage()">播放</button>
        </div>
    </div>

    <script>
        const video = document.getElementById('train-video');
        const revealDiv = document.getElementById('reveal-text');
        const input = document.getElementById('userMsg');

        function revealMessage() {
            const msg = input.value || "白六愛媽媽";
            
            // 1. 初始化狀態
            revealDiv.innerText = msg;
            revealDiv.style.width = "0%"; // 先藏起來
            revealDiv.style.transition = "none";
            video.currentTime = 0;
            video.play();

            // 2. 監控火車駛離 (3.51秒開始)
            // 我們讓 width 隨著時間增加，模擬「遮蔽物移開」
            const startTime = 3.51;
            const duration = 1.49; // 假設 5 秒時完全移開 (5 - 3.51)

            const updateReveal = () => {
                if (video.currentTime >= startTime) {
                    // 計算露出百分比 (0% 到 100%)
                    let progress = (video.currentTime - startTime) / duration;
                    if (progress > 1) progress = 1;
                    
                    revealDiv.style.width = (progress * 100) + "%";
                }
                
                if (video.currentTime < 5) {
                    requestAnimationFrame(updateReveal);
                } else {
                    revealDiv.style.width = "100%";
                }
            };

            requestAnimationFrame(updateReveal);
        }
    </script>
</body>
</html>
